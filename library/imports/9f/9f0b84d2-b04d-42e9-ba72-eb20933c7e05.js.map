{"version":3,"sources":["../../../../assets/Script/assets/Script/APLLoader.js"],"names":["urlGET","urlPOST","_crypt","require","iv","key","cypherText","originalText","cc","Class","extends","Component","properties","btnGet","default","type","Button","btnPost","btnEncrypt","btnDecrypt","btnClear","inputGet","EditBox","inputPost","inputValue","inputIV","inputKey","lblLog","Label","lblResult","txtURLGet","txtURLPost","msgLog","msgDecrypt","start","node","on","getAPILoader","loadAPILoader","clearMSG","encrypt_data","decrypt_data","string","xhr","XMLHttpRequest","open","onload","users","JSON","parse","responseText","readyState","status","console","log","withCredentials","send","data","param","json","stringify","setRequestHeader","print_data_callback_get","message","print_data_callback_post","_error","_iv","parseInt","_strKey","_value","generateRandomIV","getHashSha256","encrypt","undefined","decrypt","e"],"mappings":"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","file":"APLLoader.js","sourceRoot":"../../../../assets/Script","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\nvar urlGET       = '';\nvar urlPOST      = '';\nvar _crypt       = require('cryptlib');   \nvar iv           = '';\nvar key          = '';\nvar cypherText   = '';\nvar originalText = '';\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        btnGet:     { default: null, type: cc.Button },\n        btnPost:    { default: null, type: cc.Button },\n        btnEncrypt: { default: null, type: cc.Button },\n        btnDecrypt: { default: null, type: cc.Button },\n        btnClear:   { default: null, type: cc.Button },\n\n        inputGet:   { default: null, type: cc.EditBox },\n        inputPost:  { default: null, type: cc.EditBox },\n        inputValue: { default: null, type: cc.EditBox },\n        inputIV:    { default: null, type: cc.EditBox },\n        inputKey:   { default: null, type: cc.EditBox },\n\n        lblLog:     { default: null, type: cc.Label },\n        lblResult:  { default: null, type: cc.Label },\n\n        // defaults, set visually when attaching this script to the Canvas        \n        txtURLGet:  'http://192.168.12.43:8888/API/result.json',\n        txtURLPost: '',\n        msgLog:     'Log : \\n',\n        msgDecrypt: 'decrypt aes 128 : \\n',\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n    // onLoad () {},\n\n    start () {\n        //clear value \n        iv           = '';\n        key          = '';\n        cypherText   = '';\n        originalText = '';\n\n        // Add listener callback.\n        this.btnGet.node.on('click', this.getAPILoader, this);\n        this.btnPost.node.on('click', this.loadAPILoader, this);\n        this.btnClear.node.on('click', this.clearMSG, this);\n        this.btnEncrypt.node.on('click', this.encrypt_data, this);\n        this.btnDecrypt.node.on('click', this.decrypt_data, this);\n    \n        // Define construct value.\n        this.inputGet.string  = this.txtURLGet;\n        this.inputPost.string = this.txtURLPost;\n    },\n\n    // update (dt) {},\n\n    getAPILoader: function(Button) {\n        urlGET = this.inputGet.string;        \n\n        this.msgLog += 'click get data from => ' + urlGET + '\\n';\n        this.lblLog.string = this.msgLog;\n        var xhr = new XMLHttpRequest();\n        \n        xhr.open('GET', urlGET, true);           \n        xhr.onload = function () {\n            var users = JSON.parse(xhr.responseText);\n            if (xhr.readyState == 4 && xhr.status == \"200\") {\n                console.log(users);    \n                // this.print_data_callback_get(JSON.stringify(users));                \n            } else {\n                console.log(users);       \n                // this.print_data_callback_get.apply(xhr, JSON.stringify(users));                 \n            }\n        }\n        // xhr.callback = this.print_data_callback_get;  \n        xhr.withCredentials = false;\n        xhr.send(null);                  \n    },\n\n    loadAPILoader: function(Button) {\n        urlPOST = this.inputPost.string;\n        this.msgLog += 'click post data to => ' + urlPOST + '\\n';\n        this.lblLog.string = this.msgLog;\n\n        if(urlPOST === '')\n        {\n            var data    = {};\n            data.param  = \"Tanet(ice)\";\n            data.status = 200;\n            var json    = JSON.stringify(data);\n            var xhr     = new XMLHttpRequest();\n              \n            xhr.open(\"POST\", urlPOST, true);\n            xhr.setRequestHeader('Content-type','application/json; charset=utf-8');\n            xhr.onload = function () {\n                var users = JSON.parse(xhr.responseText);\n                if (xhr.readyState == 4 && xhr.status == \"201\") {\n                    console.log(users);\n                    // this.print_data_callback_post.apply(xhr, JSON.stringify(users));    \n                } else {\n                    console.log(users);\n                    // this.print_data_callback_post.apply(xhr, JSON.stringify(users));    \n                }\n            }\n            // xhr.callback = this.print_data_callback_post;\n            xhr.withCredentials = false;            \n            xhr.send(json);\n        }\n    },\n\n    clearMSG: function(Button) {\n        console.log('clear');\n        this.msgLog = 'Log :\\n';\n        this.lblLog.string = this.msgLog;\n        this.msgDecrypt = 'decrypt aes 128 : \\n';\n        this.lblResult.string = this.msgDecrypt;    \n    },\n\n    print_data_callback_get: function(message) {\n        this.msgLog += message + '\\n';\n        this.lblLog.string = this.msgLog;\n    },\n\n    print_data_callback_post: function(message) {\n        this.msgLog += message + '\\n';\n        this.lblLog.string = this.msgLog;\n    },\n\n    encrypt_data: function(Button) {                    \n        var _error = false;\n        this.cypherText = '';\n        this.msgLog = 'Log :\\n';\n        if (this.inputIV.string == '') {\n            _error = true;\n            this.msgLog += '->> Input IV\\n';\n        }\n        if (this.inputValue.string == '') {\n            _error = true;\n            this.msgLog += '->> Input value string\\n';\n        }\n        if (this.inputKey.string == '') {\n            _error = true;\n            this.msgLog += '->>Input secret key string\\n';\n        }\n        \n        if (!_error) {\n            var _iv = parseInt(this.inputIV.string);\n            var _strKey = this.inputKey.string;\n            var _value = this.inputValue.string;\n            iv = _crypt.generateRandomIV(_iv); //16 bytes = 128 bit\n            key = _crypt.getHashSha256(_strKey, 32); //32 bytes = 256 bits\n            cypherText = _crypt.encrypt(_value, key, iv);\n\n            this.msgDecrypt = 'Encrypt AES ---------------- :\\n' + \n                            ' :> IV (Initialization vector) : ' + _iv + '\\n' +\n                            ' :> Key string('+ _strKey+')' + ' bytes ' + 32 + '\\n' +\n                            ' :> Generate Random IV : ' + iv + '\\n' +\n                            ' :> Get HashSha 256bits or 32 bytes : ' + key + '\\n' +\n                            ' :> Encrypted : ' + cypherText;                        \n            this.lblResult.string = this.msgDecrypt;                \n        }\n        else this.lblLog.string = this.msgLog;\n    },\n\n    decrypt_data: function(Button) {         \n        var _error = false;\n        console.log(cypherText);\n        if (cypherText == undefined || cypherText == '') {\n            _error = true;\n            this.msgLog += '->> String encrypt is null!\\n';            \n        }\n        if (this.inputKey.string == '') {\n            _error = true;\n            this.msgLog += '->>Input secret key string\\n';\n        }\n\n        if (!_error) {\n            var _strKey = this.inputKey.string;\n            key = _crypt.getHashSha256(_strKey, 32); //32 bytes = 256 bits\n            try {\n                originalText = _crypt.decrypt(cypherText, key, iv);\n                this.msgDecrypt += '\\nDecrypt AES ---------------- :\\n' + \n                            ' :> Decrypted :> ' + originalText;\n                this.lblResult.string = this.msgDecrypt;   \n            }\n            catch(e) {\n                this.msgLog += e +'\\n';\n                this.lblLog.string = this.msgLog;\n            }\n             \n        }\n        else this.lblLog.string = this.msgLog;\n    },\n});\n"]}